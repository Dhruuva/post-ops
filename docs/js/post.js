(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["post"],{1681:function(t,e,n){},"37d3":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-main",{staticClass:"grey lighten-3"},[a("v-container",[a("v-row",{attrs:{"no-gutters":"",dense:""}},[a("v-col",{staticClass:"pa-2",attrs:{cols:"12",sm:"5",md:"5"}},[a("v-card",{staticClass:"ma-1",class:t.dialog?"noCard":"yesCard",attrs:{"max-height":"900",loading:t.loading}},[a("v-toolbar",{staticClass:"primary darken-1",attrs:{dense:"",dark:""}}),a("v-form",{ref:"form",attrs:{align:"center",justify:"center"}},[a("v-text-field",{staticClass:"mx-4 mt-4",attrs:{"prepend-icon":"mdi-page-layout-header",label:"Topic",outlined:"",placeholder:"Topic",dense:"",rules:t.nameRules,required:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),a("v-textarea",{staticClass:"mx-4",attrs:{outlined:"",name:"postMsg",label:"Write message here",value:"Ogog ",rules:t.msgRules,required:""},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),a("v-card-actions",[a("v-btn",{staticClass:"primary darken-2",attrs:{dark:""},on:{click:t.submitForm}},[t._v("Post")])],1)],1)],1),a("v-col",{staticClass:"pa-2",attrs:{cols:"12",sm:"7",md:"7"}},[a("v-card",{attrs:{loading:t.loading}},[a("v-toolbar",{staticClass:"info lighten-2",attrs:{dense:"",dark:""}},[a("v-btn",{staticClass:"secondary lighten-3",attrs:{dark:"",small:""},on:{click:t.loadPosts}},[t._v("Get posts ")])],1),a("v-list",{attrs:{dense:"",subheader:"","three-line":""}},[t._l(t.items,(function(e,o){return[a("v-list-item",{key:e._id,scopedSlots:t._u([{key:"default",fn:function(o){o.active;return[a("v-list-item-content",[a("v-list-item-icon",[a("v-avatar",{staticClass:"mr-2",attrs:{color:"grey",size:"30",fab:""}},[e.author.profilePicture?a("v-img",{attrs:{src:e.author.profilePicture,alt:"Avatar"}}):a("v-img",{attrs:{src:n("5d1e"),alt:"Avatar"}})],1),a("v-list-item-title",{staticClass:"primary--text",domProps:{textContent:t._s(e.author.name)}})],1),a("v-list-item-subtitle",{attrs:{color:"red"},domProps:{textContent:t._s(e.title)}}),a("v-list-item-subtitle",{domProps:{textContent:t._s(e.content)}})],1),a("v-list-item-action",[a("v-btn",{attrs:{icon:"",color:"yellow darken-3",disabled:e.author._id!==t.myID},on:{click:function(n){return t.editPost(e)}}},[a("v-icon",[t._v("| mdi-pencil")])],1),a("v-btn",{attrs:{icon:"",color:"red lighten-1",disabled:e.author._id!==t.myID},on:{click:function(n){return t.killPost(e._id)}}},[a("v-icon",[t._v("| mdi-delete")])],1)],1)]}}],null,!0)}),o<t.items.length-1?a("v-divider",{key:o}):t._e()]}))],2)],1)],1)],1),a("v-dialog",{staticClass:"pa-2",attrs:{"max-width":"490"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",{attrs:{"max-height":"900",loading:t.loading}},[a("v-toolbar",{staticClass:"primary lighten-3",attrs:{dense:"",dark:""}},[t._v(t._s(t.dialog))]),a("v-form",{ref:"form2",attrs:{align:"center",justify:"center","lazy-validation":""}},[a("v-text-field",{staticClass:"mx-4 mt-4",attrs:{"prepend-icon":"mdi-page-layout-header",label:"Topic",outlined:"",placeholder:"Topic",dense:"",rules:t.nameRules,required:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),a("v-textarea",{staticClass:"mx-4",staticStyle:{"white-space":"pre-line"},attrs:{outlined:"",name:"postMsg",label:"Write message here",value:"Ogog ",rules:t.msgRules,required:""},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),a("v-card-actions",[a("v-btn",{staticClass:"primary lighten-3",attrs:{dark:""},on:{click:t.updatePost}},[t._v("Update ")])],1)],1)],1)],1)],1)},o=[],r=n("2909"),i=n("1da1"),s=(n("96cf"),n("d3b7"),n("c740"),n("a434"),{name:"post",data:function(){return{title:"",content:"",loading:!1,validToken:null,myID:"",cPost:null,dialog:!1,nameRules:[function(t){return!!t||"Name is required"},function(t){return t&&t.length>=4||"Name must be more than 4 characters"}],msgRules:[function(t){return!!t||"No empty post"},function(t){return t&&t.length<=255||"Name must be less than 255 characters"}],items:[]}},mounted:function(){this.$nextTick((function(){this.myID=this.myIDis()}))},watch:{dialog:function(t){var e=this;t||(this.content="",this.title="",setTimeout((function(){e.$refs.form.resetValidation()}),50))}},methods:{submitForm:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.$refs.form.validate(),!n){e.next=9;break}if(t.validToken||(t.validToken=t.getToken()),t.validToken){e.next=6;break}return t.$router.push({name:"Login",params:{msg:"Please reLogin"}}),e.abrupt("return");case 6:return t.loading=!0,e.next=9,fetch("https://post-ops.herokuapp.com/api/posts/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8",Authorization:t.validToken},body:JSON.stringify({title:"".concat(t.title),content:"".concat(t.content)})}).then((function(t){return t.json()})).then((function(e){if(e.error&&"Need to pass a valid token"==e.error)return localStorage.removeItem("LoggedUser"),void t.$router.push({name:"Login",params:{msg:"Please reLogin"}});t.items.unshift(e.data),t.dialog&&(t.dialog=!1),t.loading=!1})).catch((function(e){console.error("Post Error:",e),t.loading=!1}));case 9:case"end":return e.stop()}}),e)})))()},loadPosts:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.validToken||(t.validToken=t.getToken()),t.validToken){e.next=5;break}return localStorage.removeItem("LoggedUser"),t.$router.push({name:"Login",params:{msg:"Please reLogin"}}),e.abrupt("return");case 5:return t.loading=!0,e.next=8,fetch("https://post-ops.herokuapp.com/api/posts/feed/",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then((function(t){return t.json()})).then((function(e){while(t.items.length>0)t.items.pop();t.items=Object(r["a"])(e),t.loading=!1})).catch((function(e){console.error("Post Error:",e),t.loading=!1}));case 8:case"end":return e.stop()}}),e)})))()},killPost:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.loading=!0,n.next=3,fetch("https://post-ops.herokuapp.com/api/posts/"+t,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8",Authorization:e.validToken}}).then((function(t){return t.json()})).then((function(n){if(n.error&&"Need to pass a valid token"==n.error)return localStorage.removeItem("LoggedUser"),void e.$router.push({name:"Login",params:{msg:"Please reLogin"}});var a=e.items.findIndex((function(e){return e._id==t}));e.items.splice(a,1),e.loading=!1})).catch((function(t){return console.error("Error:",t),e.loading=!1,t}));case 3:case"end":return n.stop()}}),n)})))()},editPost:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.cPost=t,e.content=t.content,e.title=t.title,e.dialog=!0;case 4:case"end":return n.stop()}}),n)})))()},updatePost:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={content:"".concat(t.content),title:"".concat(t.title)},a=t.$refs.form.validate(),!a){e.next=11;break}if(t.validToken||(t.validToken=t.getToken()),t.validToken){e.next=8;break}return localStorage.removeItem("LoggedUser"),t.$router.push({name:"Login",params:{msg:"Please reLogin"}}),e.abrupt("return");case 8:return t.loading=!0,e.next=11,fetch("https://post-ops.herokuapp.com/api/posts/"+t.cPost._id,{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8",Authorization:t.validToken},body:JSON.stringify(n)}).then((function(t){return t.json()})).then((function(e){e.error&&"Need to pass a valid token"==e.error?t.$router.push({name:"Login",params:{msg:"Please reLogin"}}):(t.cPost.content=t.content,t.cPost.title=t.title,t.$refs.form.reset(),t.dialog&&(t.dialog=!1),t.loading=!1)})).catch((function(e){console.error("PATCH Error:",e),t.loading=!1}));case 11:case"end":return e.stop()}}),e)})))()}}}),c=s,l=(n("98de"),n("2877")),u=n("6544"),d=n.n(u),p=n("8212"),m=n("8336"),h=n("b0af"),g=n("99d9"),f=n("62ad"),v=n("a523"),k=n("169a"),b=n("ce7e"),x=n("4bd4"),w=n("132d"),y=n("adda"),T=n("8860"),C=n("da13"),P=n("1800"),I=n("5d23"),V=n("34c3"),L=n("f6c4"),j=n("0fd9"),R=n("8654"),_=n("5530"),$=(n("a9e3"),n("1681"),n("58df")),N=Object($["a"])(R["a"]),A=N.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(t){return!isNaN(parseFloat(t))}},rows:{type:[Number,String],default:5,validator:function(t){return!isNaN(parseInt(t,10))}}},computed:{classes:function(){return Object(_["a"])({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},R["a"].options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var t=this;setTimeout((function(){t.autoGrow&&t.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var t=this.$refs.input;if(t){t.style.height="0";var e=t.scrollHeight,n=parseInt(this.rows,10)*parseFloat(this.rowHeight);t.style.height=Math.max(n,e)+"px"}},genInput:function(){var t=R["a"].options.methods.genInput.call(this);return t.tag="textarea",delete t.data.attrs.type,t.data.attrs.rows=this.rows,t},onInput:function(t){R["a"].options.methods.onInput.call(this,t),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(t){this.isFocused&&13===t.keyCode&&t.stopPropagation(),this.$emit("keydown",t)}}}),O=n("71d9"),H=Object(l["a"])(c,a,o,!1,null,null,null);e["default"]=H.exports;d()(H,{VAvatar:p["a"],VBtn:m["a"],VCard:h["a"],VCardActions:g["a"],VCol:f["a"],VContainer:v["a"],VDialog:k["a"],VDivider:b["a"],VForm:x["a"],VIcon:w["a"],VImg:y["a"],VList:T["a"],VListItem:C["a"],VListItemAction:P["a"],VListItemContent:I["a"],VListItemIcon:V["a"],VListItemSubtitle:I["b"],VListItemTitle:I["c"],VMain:L["a"],VRow:j["a"],VTextField:R["a"],VTextarea:A,VToolbar:O["a"]})},"5d1e":function(t,e,n){t.exports=n.p+"img/man.png"},"5db8":function(t,e,n){},"98de":function(t,e,n){"use strict";n("5db8")}}]);
//# sourceMappingURL=post.js.map